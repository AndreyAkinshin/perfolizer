using System.Collections.Generic;
using System.Linq;
using JetBrains.Annotations;
using Perfolizer.Mathematics.Distributions;
using Perfolizer.Tests.Common;
using Xunit;
using Xunit.Abstractions;

namespace Perfolizer.Tests.Mathematics.Distributions
{
    public class StudentDistributionTests : DistributionTestsBase
    {
        public StudentDistributionTests(ITestOutputHelper output) : base(output)
        {
        }

        private static readonly List<TestData> TestDataList = new()
        {
            new TestData(new StudentDistribution(1),
                new[]
                {
                    -10, -9.8, -9.6, -9.4, -9.2, -9, -8.8, -8.6, -8.4, -8.2, -8,
                    -7.8, -7.6, -7.4, -7.2, -7, -6.8, -6.6, -6.4, -6.2, -6, -5.8,
                    -5.6, -5.4, -5.2, -5, -4.8, -4.6, -4.4, -4.2, -4, -3.8, -3.6,
                    -3.4, -3.2, -3, -2.8, -2.6, -2.4, -2.2, -2, -1.8, -1.6, -1.4,
                    -1.2, -1, -0.799999999999999, -0.6, -0.399999999999999, -0.199999999999999,
                    0, 0.200000000000001, 0.4, 0.600000000000001, 0.800000000000001,
                    1, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.4, 2.6, 2.8, 3, 3.2, 3.4, 3.6,
                    3.8, 4, 4.2, 4.4, 4.6, 4.8, 5, 5.2, 5.4, 5.6, 5.8, 6, 6.2, 6.4,
                    6.6, 6.8, 7, 7.2, 7.4, 7.6, 7.8, 8, 8.2, 8.4, 8.6, 8.8, 9, 9.2,
                    9.4, 9.6, 9.8, 10
                },
                new[]
                {
                    0.00315158303152268, 0.00328019256166314, 0.00341680856788097,
                    0.00356210705219103, 0.00371683659719513, 0.00388182788029013,
                    0.00405800466832982, 0.00424639656061621, 0.00444815380357449,
                    0.00466456456893011, 0.00489707517205832, 0.00514731381280386,
                    0.00541711855316186, 0.00570857041219137, 0.00602403266812625,
                    0.00636619772367581, 0.00673814322997017, 0.00714339960017484,
                    0.0075860316059054, 0.00807073747930504, 0.00860296989685921,
                    0.00918908447412791, 0.00983652305883161, 0.0105540413190912,
                    0.011351993087867, 0.0122426879301458, 0.0132408438512392, 0.0143641645389797,
                    0.0156340808538208, 0.0170767106321776, 0.0187241109519877, 0.0206159252709709,
                    0.0228015677782085, 0.0253431438044419, 0.0283193848917963, 0.0318309886183791,
                    0.0360079056768994, 0.0410193152298699, 0.0470872612697915, 0.0545051174972245,
                    0.0636619772367581, 0.0750730863641016, 0.0894128893774693, 0.10753712371074,
                    0.1304548713868, 0.159154943091895, 0.194091394014507, 0.234051386899846,
                    0.274405074296372, 0.306067198253645, 0.318309886183791, 0.306067198253645,
                    0.274405074296371, 0.234051386899846, 0.194091394014506, 0.159154943091895,
                    0.130454871386799, 0.10753712371074, 0.0894128893774692, 0.0750730863641016,
                    0.0636619772367581, 0.0545051174972244, 0.0470872612697915, 0.0410193152298699,
                    0.0360079056768994, 0.0318309886183791, 0.0283193848917963, 0.0253431438044419,
                    0.0228015677782085, 0.0206159252709709, 0.0187241109519877, 0.0170767106321776,
                    0.0156340808538208, 0.0143641645389797, 0.0132408438512392, 0.0122426879301458,
                    0.011351993087867, 0.0105540413190912, 0.0098365230588316, 0.00918908447412791,
                    0.00860296989685921, 0.00807073747930504, 0.0075860316059054,
                    0.00714339960017483, 0.00673814322997017, 0.00636619772367581,
                    0.00602403266812625, 0.00570857041219136, 0.00541711855316186,
                    0.00514731381280386, 0.00489707517205832, 0.00466456456893011,
                    0.00444815380357449, 0.0042463965606162, 0.00405800466832982,
                    0.00388182788029013, 0.00371683659719513, 0.00356210705219103,
                    0.00341680856788097, 0.00328019256166314, 0.00315158303152268
                },
                new[]
                {
                    0.0317255174305536, 0.0323685668308654, 0.0330381280776306,
                    0.0337358689289317, 0.0344635994538435, 0.0352232874772773, 0.0360170760716513,
                    0.0368473034174359, 0.0377165254135488, 0.0386275414898551, 0.0395834241605655,
                    0.0405875529628379, 0.0416436535540548, 0.042755842900092, 0.0439286816831025,
                    0.0451672353008665, 0.0464771451335144, 0.0478647121342451, 0.049336995280668,
                    0.0509019280317873, 0.0525684567112534, 0.0543467057322627, 0.0562481758633212,
                    0.0582859834018422, 0.0604751503036597, 0.0628329581890012, 0.0653793829556702,
                    0.0681376318216244, 0.0711348114738153, 0.0744027652986172, 0.0779791303773693,
                    0.0819086824248374, 0.0862450610930792, 0.0910530018557488, 0.0964112479792296,
                    0.102416382349567, 0.10918791143363, 0.116875061252343, 0.125665916378002,
                    0.135799748780092, 0.147583617650433, 0.161414467217095, 0.177807684489353,
                    0.197431543288746, 0.221142061623695, 0.25, 0.285223287477278,
                    0.327979130377369, 0.378881058409157, 0.437167041810999, 0.5,
                    0.562832958189001, 0.621118941590843, 0.672020869622631, 0.714776712522723,
                    0.75, 0.778857938376305, 0.802568456711254, 0.822192315510647,
                    0.838585532782905, 0.852416382349567, 0.864200251219908, 0.874334083621998,
                    0.883124938747657, 0.890812088566371, 0.897583617650433, 0.90358875202077,
                    0.908946998144251, 0.913754938906921, 0.918091317575163, 0.922020869622631,
                    0.925597234701383, 0.928865188526185, 0.931862368178376, 0.93462061704433,
                    0.937167041810999, 0.93952484969634, 0.941714016598158, 0.943751824136679,
                    0.945653294267737, 0.947431543288747, 0.949098071968213, 0.950663004719332,
                    0.952135287865755, 0.953522854866486, 0.954832764699133, 0.956071318316897,
                    0.957244157099908, 0.958356346445945, 0.959412447037162, 0.960416575839435,
                    0.961372458510145, 0.962283474586451, 0.963152696582564, 0.963982923928349,
                    0.964776712522723, 0.965536400546156, 0.966264131071068, 0.966961871922369,
                    0.967631433169135, 0.968274482569446
                },
                DefaultProbs,
                new[]
                {
                    double.NegativeInfinity, -31.820515953774, -15.8945448438653, -10.5788949934056, -7.91581508830583,
                    -6.31375151467504, -5.24218358111318, -4.47374282921156, -3.89474285492986,
                    -3.44202257666922, -3.07768353717525, -2.77760685391498, -2.52571168944731,
                    -2.31086365388241, -2.1251081731572, -1.96261050550515, -1.81899324728107,
                    -1.69090765578501, -1.57574785996865, -1.47145531581997, -1.37638192047117,
                    -1.28919223178507, -1.20879235040961, -1.13427734925541, -1.06489184032479,
                    -1, -0.939062505817492, -0.881618592363189, -0.827271945972475,
                    -0.775679511049613, -0.726542528005361, -0.679599298224527, -0.634619297544148,
                    -0.591398351399471, -0.54975465219277, -0.509525449494429, -0.470564281212251,
                    -0.432738642247426, -0.395928008797721, -0.360022153095757, -0.324919696232906,
                    -0.290526856731916, -0.256756360367727, -0.223526482897149, -0.190760202218567,
                    -0.158384440324536, -0.126329378446108, -0.094527831179282, -0.0629146672536497,
                    -0.0314262660433513, 0, 0.0314262660433513, 0.0629146672536499,
                    0.0945278311792822, 0.126329378446108, 0.158384440324537, 0.190760202218567,
                    0.223526482897149, 0.256756360367727, 0.290526856731916, 0.324919696232906,
                    0.360022153095757, 0.395928008797721, 0.432738642247426, 0.470564281212251,
                    0.509525449494429, 0.54975465219277, 0.591398351399471, 0.634619297544148,
                    0.679599298224527, 0.726542528005361, 0.775679511049614, 0.827271945972475,
                    0.881618592363189, 0.939062505817492, 1, 1.06489184032479, 1.13427734925541,
                    1.20879235040961, 1.28919223178507, 1.37638192047117, 1.47145531581997,
                    1.57574785996865, 1.69090765578501, 1.81899324728107, 1.96261050550515,
                    2.1251081731572, 2.31086365388241, 2.52571168944731, 2.77760685391498,
                    3.07768353717525, 3.44202257666922, 3.89474285492986, 4.47374282921156,
                    5.24218358111318, 6.31375151467505, 7.91581508830584, 10.5788949934056,
                    15.8945448438653, 31.8205159537739, double.PositiveInfinity
                }),
            new TestData(new StudentDistribution(2),
                new[]
                {
                    -10, -9.8, -9.6, -9.4, -9.2, -9, -8.8, -8.6, -8.4, -8.2, -8,
                    -7.8, -7.6, -7.4, -7.2, -7, -6.8, -6.6, -6.4, -6.2, -6, -5.8,
                    -5.6, -5.4, -5.2, -5, -4.8, -4.6, -4.4, -4.2, -4, -3.8, -3.6,
                    -3.4, -3.2, -3, -2.8, -2.6, -2.4, -2.2, -2, -1.8, -1.6, -1.4,
                    -1.2, -1, -0.799999999999999, -0.6, -0.399999999999999, -0.199999999999999,
                    0, 0.200000000000001, 0.4, 0.600000000000001, 0.800000000000001,
                    1, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.4, 2.6, 2.8, 3, 3.2, 3.4, 3.6,
                    3.8, 4, 4.2, 4.4, 4.6, 4.8, 5, 5.2, 5.4, 5.6, 5.8, 6, 6.2, 6.4,
                    6.6, 6.8, 7, 7.2, 7.4, 7.6, 7.8, 8, 8.2, 8.4, 8.6, 8.8, 9, 9.2,
                    9.4, 9.6, 9.8, 10
                },
                new[]
                {
                    0.000970732885271249, 0.0010301371420425, 0.00109446108746624,
                    0.00116422163770437, 0.00124000185420574, 0.00132246096373121,
                    0.00141234613817095, 0.00151050638674196, 0.00161790899270579,
                    0.00173565902629179, 0.00186502259059595, 0.00200745461507795,
                    0.00216463221136304, 0.00233849486082584, 0.00253129302934954,
                    0.00274564722358433, 0.00298462004415893, 0.00325180449377722,
                    0.00355143271471924, 0.00388851053240875, 0.00426898476659901,
                    0.00469995237214371, 0.00518992326936783, 0.00574915247031466,
                    0.00639006214725556, 0.00712778110110649, 0.0079808383284488,
                    0.00897205996247175, 0.0101297360114212, 0.0114891467007771,
                    0.0130945700219731, 0.0150019350263683, 0.0172823425800474, 0.0200267495056626,
                    0.0233522038592741, 0.0274101222343422, 0.0323971907044379, 0.0385694850684638,
                    0.0462601906325862, 0.0559005199489673, 0.0680413817439772, 0.083368707696664,
                    0.102695812673431, 0.12689871404788, 0.156733681981742, 0.192450089729875,
                    0.233127823824494, 0.275823963942423, 0.315006396962857, 0.343205902948042,
                    0.353553390593274, 0.343205902948042, 0.315006396962857, 0.275823963942423,
                    0.233127823824494, 0.192450089729875, 0.156733681981742, 0.12689871404788,
                    0.102695812673431, 0.0833687076966639, 0.0680413817439772, 0.0559005199489673,
                    0.0462601906325862, 0.0385694850684638, 0.0323971907044379, 0.0274101222343422,
                    0.0233522038592741, 0.0200267495056625, 0.0172823425800474, 0.0150019350263683,
                    0.0130945700219731, 0.0114891467007771, 0.0101297360114212, 0.00897205996247174,
                    0.00798083832844879, 0.00712778110110649, 0.00639006214725555,
                    0.00574915247031465, 0.00518992326936783, 0.00469995237214371,
                    0.00426898476659901, 0.00388851053240875, 0.00355143271471923,
                    0.00325180449377721, 0.00298462004415893, 0.00274564722358433,
                    0.00253129302934954, 0.00233849486082584, 0.00216463221136304,
                    0.00200745461507795, 0.00186502259059595, 0.00173565902629179,
                    0.00161790899270579, 0.00151050638674196, 0.00141234613817095,
                    0.00132246096373121, 0.00124000185420574, 0.00116422163770437,
                    0.00109446108746624, 0.0010301371420425, 0.000970732885271249
                },
                new[]
                {
                    0.00492622851166285, 0.00512623751134916, 0.00533861122005628,
                    0.00556438424005419, 0.00580470101742898, 0.00606083004639343,
                    0.00633418024827973, 0.00662631991124814, 0.006938998654924,
                    0.00727417298018283, 0.00763403608266907, 0.00802105275515586,
                    0.00843800038598919, 0.00888801728824353, 0.00937465987935432,
                    0.00990197059019657, 0.0104745588372293, 0.0110976979695832,
                    0.0117774418421173, 0.0125207656151098, 0.0133357366077124, 0.0142317226247142,
                    0.0152196472548894, 0.0163123043674874, 0.0175247476336164, 0.0188747756753119,
                    0.0203835398135411, 0.0220763099190549, 0.023983445351293, 0.0261416334731496,
                    0.0285954792089683, 0.0313995575163594, 0.0346210790044828, 0.0383433703954669,
                    0.0426704396199764, 0.0477329831333546, 0.0536963008556632, 0.0607707040403341,
                    0.0692251048293571, 0.0794044879039701, 0.091751709536137, 0.106833174502533,
                    0.125365675367322, 0.148236764659276, 0.176501680389685, 0.211324865405187,
                    0.253817018041335, 0.304716633528764, 0.363917236512046, 0.4299859957986,
                    0.5, 0.570014004201401, 0.636082763487954, 0.695283366471236,
                    0.746182981958666, 0.788675134594813, 0.823498319610315, 0.851763235340724,
                    0.874634324632678, 0.893166825497467, 0.908248290463863, 0.92059551209603,
                    0.930774895170643, 0.939229295959666, 0.946303699144337, 0.952267016866645,
                    0.957329560380024, 0.961656629604533, 0.965378920995517, 0.968600442483641,
                    0.971404520791032, 0.97385836652685, 0.976016554648707, 0.977923690080945,
                    0.979616460186459, 0.981125224324688, 0.982475252366384, 0.983687695632513,
                    0.984780352745111, 0.985768277375286, 0.986664263392288, 0.98747923438489,
                    0.988222558157883, 0.988902302030417, 0.989525441162771, 0.990098029409803,
                    0.990625340120646, 0.991111982711756, 0.991561999614011, 0.991978947244844,
                    0.992365963917331, 0.992725827019817, 0.993061001345076, 0.993373680088752,
                    0.99366581975172, 0.993939169953607, 0.994195298982571, 0.994435615759946,
                    0.994661388779944, 0.994873762488651, 0.995073771488337
                },
                DefaultProbs,
                new[]
                {
                    double.NegativeInfinity, -6.96455673428327, -4.84873221385061, -3.89642535976149, -3.31976404784035,
                    -2.91998558035373, -2.62016187037182, -2.38337818053688, -2.18940134759929,
                    -2.02608146554034, -1.88561808316413, -1.76273999735172, -1.65373773157913,
                    -1.55591339406537, -1.4672504626906, -1.38620656016734, -1.31157847467778,
                    -1.24241140897146, -1.1779362781317, -1.11752534556748, -1.06066017177982,
                    -1.00690802626528, -0.955904238798487, -0.907338797158432, -0.860946032092278,
                    -0.816496580927726, -0.773791056262993, -0.732655006603495, -0.692934867183583,
                    -0.654494677707282, -0.617213399848368, -0.580982707974921, -0.545705156331749,
                    -0.511292647969764, -0.477665147221226, -0.444749589996661, -0.412478955692153,
                    -0.38079147180858, -0.349629928048839, -0.318941081077404, -0.288675134594813,
                    -0.258785282117425, -0.229227302024501, -0.199959196164015, -0.170940864689456,
                    -0.142133810903739, -0.113500870767833, -0.0850059624328604,
                    -0.0566138517072297, -0.0282899297993336, 0, 0.0282899297993336,
                    0.0566138517072298, 0.0850059624328606, 0.113500870767833, 0.142133810903741,
                    0.170940864689458, 0.199959196164015, 0.229227302024501, 0.258785282117425,
                    0.288675134594813, 0.318941081077404, 0.349629928048839, 0.38079147180858,
                    0.412478955692153, 0.444749589996661, 0.477665147221226, 0.511292647969764,
                    0.545705156331749, 0.580982707974921, 0.617213399848368, 0.654494677707282,
                    0.692934867183583, 0.732655006603495, 0.773791056262993, 0.816496580927726,
                    0.860946032092278, 0.907338797158432, 0.955904238798487, 1.00690802626528,
                    1.06066017177982, 1.11752534556748, 1.1779362781317, 1.24241140897146,
                    1.31157847467778, 1.38620656016734, 1.4672504626906, 1.55591339406537,
                    1.65373773157913, 1.76273999735172, 1.88561808316413, 2.02608146554034,
                    2.18940134759929, 2.38337818053688, 2.62016187037182, 2.91998558035373,
                    3.31976404784035, 3.89642535976149, 4.84873221385061, 6.96455673428327, double.PositiveInfinity
                })
        };

        [UsedImplicitly]
        public static TheoryData<string> TestDataKeys = TheoryDataHelper.Create(TestDataList.Select(it => it.Distribution.ToString()));

        [Theory]
        [MemberData(nameof(TestDataKeys))]
        public void StudentDistributionTest([NotNull] string testKey)
        {
            Check(TestDataList.First(it => it.Distribution.ToString() == testKey));
        }
    }
}