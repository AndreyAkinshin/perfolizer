using System.Collections.Generic;
using System.Linq;
using JetBrains.Annotations;
using Perfolizer.Mathematics.Distributions.ContinuousDistributions;
using Perfolizer.Tests.Common;
using Xunit;
using Xunit.Abstractions;

namespace Perfolizer.Tests.Mathematics.Distributions.ContinuousDistributions
{
    public class NormalDistributionTests : DistributionTestsBase
    {
        public NormalDistributionTests(ITestOutputHelper output) : base(output)
        {
        }

        private static readonly List<TestData> TestDataList = new()
        {
            new TestData(new NormalDistribution(),
                new[]
                {
                    -10, -9.8, -9.6, -9.4, -9.2, -9, -8.8, -8.6, -8.4, -8.2, -8,
                    -7.8, -7.6, -7.4, -7.2, -7, -6.8, -6.6, -6.4, -6.2, -6, -5.8,
                    -5.6, -5.4, -5.2, -5, -4.8, -4.6, -4.4, -4.2, -4, -3.8, -3.6,
                    -3.4, -3.2, -3, -2.8, -2.6, -2.4, -2.2, -2, -1.8, -1.6, -1.4,
                    -1.2, -1, -0.799999999999999, -0.6, -0.399999999999999, -0.199999999999999,
                    0, 0.200000000000001, 0.4, 0.600000000000001, 0.800000000000001,
                    1, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.4, 2.6, 2.8, 3, 3.2, 3.4, 3.6,
                    3.8, 4, 4.2, 4.4, 4.6, 4.8, 5, 5.2, 5.4, 5.6, 5.8, 6, 6.2, 6.4,
                    6.6, 6.8, 7, 7.2, 7.4, 7.6, 7.8, 8, 8.2, 8.4, 8.6, 8.8, 9, 9.2,
                    9.4, 9.6, 9.8, 10
                },
                new[]
                {
                    7.69459862670642e-23, 5.57300002272071e-22, 3.87811193174697e-21,
                    2.59286470110038e-20, 1.66558803237993e-19, 1.02797735716689e-18,
                    6.09575812956242e-18, 3.47296274856621e-17, 1.90108153790796e-16,
                    9.99837874849721e-16, 5.05227108353689e-15, 2.45285528569643e-14,
                    1.14415649018014e-13, 5.12775363679666e-13, 2.20798996313715e-12,
                    9.13472040836459e-12, 3.6309615017918e-11, 1.38667999416532e-10,
                    5.08814028164505e-10, 1.79378390796409e-09, 6.07588284982329e-09,
                    1.97731964062447e-08, 6.18262050016586e-08, 1.8573618445553e-07,
                    5.36103534469764e-07, 1.4867195147343e-06, 3.96129909103208e-06,
                    1.01408520654868e-05, 2.49424712900536e-05, 5.89430677565401e-05,
                    0.000133830225764885, 0.00029194692579146, 0.000611901930113773,
                    0.00123221916847302, 0.00238408820146485, 0.00443184841193801,
                    0.00791545158297997, 0.0135829692336856, 0.0223945302948429,
                    0.0354745928462315, 0.0539909665131881, 0.0789501583008943, 0.110920834679456,
                    0.149727465635745, 0.194186054983213, 0.241970724519143, 0.289691552761483,
                    0.3332246028918, 0.368270140303324, 0.391042693975456, 0.398942280401433,
                    0.391042693975456, 0.368270140303323, 0.333224602891799, 0.289691552761483,
                    0.241970724519143, 0.194186054983213, 0.149727465635745, 0.110920834679455,
                    0.0789501583008941, 0.0539909665131881, 0.0354745928462314, 0.0223945302948429,
                    0.0135829692336856, 0.00791545158297995, 0.00443184841193801,
                    0.00238408820146483, 0.00123221916847302, 0.000611901930113769,
                    0.00029194692579146, 0.000133830225764885, 5.89430677565396e-05,
                    2.49424712900535e-05, 1.01408520654867e-05, 3.96129909103206e-06,
                    1.4867195147343e-06, 5.36103534469759e-07, 1.85736184455529e-07,
                    6.1826205001658e-08, 1.97731964062446e-08, 6.07588284982329e-09,
                    1.79378390796409e-09, 5.08814028164499e-10, 1.3866799941653e-10,
                    3.63096150179177e-11, 9.13472040836459e-12, 2.20798996313715e-12,
                    5.1277536367966e-13, 1.14415649018012e-13, 2.45285528569641e-14,
                    5.05227108353689e-15, 9.99837874849721e-16, 1.90108153790793e-16,
                    3.47296274856615e-17, 6.09575812956242e-18, 1.02797735716689e-18,
                    1.66558803237987e-19, 2.59286470110034e-20, 3.8781119317469e-21,
                    5.57300002272071e-22, 7.69459862670642e-23
                },
                new[]
                {
                    7.61985302416053e-24, 5.62928231137653e-23, 3.99722120572624e-22,
                    2.72815357134612e-21, 1.78974881201405e-20, 1.12858840595384e-19,
                    6.84080768593555e-19, 3.98580496284818e-18, 2.23239319728804e-17,
                    1.20193515427359e-16, 6.22096057427178e-16, 3.0953587719587e-15,
                    1.48065374900481e-14, 6.80922489062002e-14, 3.01062798111745e-13,
                    1.27981254388584e-12, 5.23095754414459e-12, 2.05578890939952e-11,
                    7.76884758170981e-11, 2.82315803704329e-10, 9.86587645037698e-10,
                    3.31574597832617e-09, 1.07175902583109e-08, 3.33204484854287e-08,
                    9.96442631693352e-08, 2.86651571879194e-07, 7.93328151975595e-07,
                    2.11245470250285e-06, 5.41254390770387e-06, 1.33457490159064e-05,
                    3.16712418331199e-05, 7.23480439251201e-05, 0.000159108590157534,
                    0.000336929265676882, 0.00068713793791585, 0.00134989803163009,
                    0.00255513033042793, 0.00466118802371875, 0.00819753592459614,
                    0.0139034475134986, 0.0227501319481792, 0.0359303191129259, 0.054799291699558,
                    0.080756659233771, 0.115069670221708, 0.158655253931457, 0.211855398583397,
                    0.274253117750074, 0.344578258389676, 0.420740290560897, 0.5,
                    0.579259709439103, 0.655421741610324, 0.725746882249927, 0.788144601416603,
                    0.841344746068543, 0.884930329778292, 0.919243340766229, 0.945200708300442,
                    0.964069680887074, 0.977249868051821, 0.986096552486501, 0.991802464075404,
                    0.995338811976281, 0.997444869669572, 0.99865010196837, 0.999312862062084,
                    0.999663070734323, 0.999840891409842, 0.999927651956075, 0.999968328758167,
                    0.999986654250984, 0.999994587456092, 0.999997887545298, 0.999999206671848,
                    0.999999713348428, 0.999999900355737, 0.999999966679551, 0.99999998928241,
                    0.999999996684254, 0.999999999013412, 0.999999999717684, 0.999999999922311,
                    0.999999999979442, 0.999999999994769, 0.99999999999872, 0.999999999999699,
                    0.999999999999932, 0.999999999999985, 0.999999999999997, 0.999999999999999,
                    1, 1, 1, 1, 1, 1, 1, 1, 1, 1
                },
                DefaultProbs,
                new[]
                {
                    double.NegativeInfinity, -2.32634787404084, -2.05374891063182, -1.88079360815125, -1.75068607125217,
                    -1.64485362695147, -1.55477359459685, -1.47579102817917, -1.40507156030963,
                    -1.34075503369022, -1.2815515655446, -1.22652812003661, -1.17498679206609,
                    -1.1263911290388, -1.08031934081496, -1.03643338949379, -0.994457883209753,
                    -0.954165253146194, -0.915365087842814, -0.877896295051228, -0.841621233572914,
                    -0.80642124701824, -0.772193214188685, -0.738846849185214, -0.706302562840088,
                    -0.674489750196082, -0.643345405392917, -0.612812991016627, -0.582841507271216,
                    -0.553384719555673, -0.524400512708041, -0.495850347347453, -0.467698799114508,
                    -0.439913165673234, -0.412463129441405, -0.385320466407568, -0.358458793251194,
                    -0.331853346436817, -0.305480788099397, -0.279319034447454, -0.2533471031358,
                    -0.227544976641149, -0.201893479141851, -0.176374164780861, -0.150969215496777,
                    -0.125661346855074, -0.10043372051147, -0.0752698620998298, -0.0501535834647335,
                    -0.0250689082587111, 0, 0.0250689082587111, 0.0501535834647337,
                    0.0752698620998299, 0.10043372051147, 0.125661346855074, 0.150969215496777,
                    0.176374164780861, 0.201893479141851, 0.227544976641149, 0.2533471031358,
                    0.279319034447454, 0.305480788099397, 0.331853346436817, 0.358458793251194,
                    0.385320466407568, 0.412463129441405, 0.439913165673234, 0.467698799114508,
                    0.495850347347453, 0.524400512708041, 0.553384719555673, 0.582841507271216,
                    0.612812991016627, 0.643345405392917, 0.674489750196082, 0.706302562840088,
                    0.738846849185214, 0.772193214188685, 0.80642124701824, 0.841621233572914,
                    0.877896295051229, 0.915365087842814, 0.954165253146195, 0.994457883209753,
                    1.03643338949379, 1.08031934081496, 1.1263911290388, 1.17498679206609,
                    1.22652812003661, 1.2815515655446, 1.34075503369022, 1.40507156030963,
                    1.47579102817917, 1.55477359459685, 1.64485362695147, 1.75068607125217,
                    1.88079360815125, 2.05374891063182, 2.32634787404084, double.PositiveInfinity
                }),
            new TestData(new NormalDistribution(1, 2),
                new[]
                {
                    -10, -9.8, -9.6, -9.4, -9.2, -9, -8.8, -8.6, -8.4, -8.2, -8,
                    -7.8, -7.6, -7.4, -7.2, -7, -6.8, -6.6, -6.4, -6.2, -6, -5.8,
                    -5.6, -5.4, -5.2, -5, -4.8, -4.6, -4.4, -4.2, -4, -3.8, -3.6,
                    -3.4, -3.2, -3, -2.8, -2.6, -2.4, -2.2, -2, -1.8, -1.6, -1.4,
                    -1.2, -1, -0.799999999999999, -0.6, -0.399999999999999, -0.199999999999999,
                    0, 0.200000000000001, 0.4, 0.600000000000001, 0.800000000000001,
                    1, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.4, 2.6, 2.8, 3, 3.2, 3.4, 3.6,
                    3.8, 4, 4.2, 4.4, 4.6, 4.8, 5, 5.2, 5.4, 5.6, 5.8, 6, 6.2, 6.4,
                    6.6, 6.8, 7, 7.2, 7.4, 7.6, 7.8, 8, 8.2, 8.4, 8.6, 8.8, 9, 9.2,
                    9.4, 9.6, 9.8, 10
                },
                new[]
                {
                    5.38488002127164e-08, 9.28680922277645e-08, 1.58567460835799e-07,
                    2.68051767234881e-07, 4.48621758119167e-07, 7.43359757367149e-07,
                    1.21948037294668e-06, 1.98064954551604e-06, 3.18491258943354e-06,
                    5.07042603274338e-06, 7.99187055345274e-06, 1.24712356450268e-05,
                    1.92675983710436e-05, 2.94715338782699e-05, 4.46308285885665e-05,
                    6.69151128824427e-05, 9.93277356963864e-05, 0.00014597346289573,
                    0.000212390135275376, 0.000305950965056886, 0.00043634134752288,
                    0.00061610958423651, 0.000861284469526841, 0.00119204410073242,
                    0.00163340952809996, 0.002215924205969, 0.00297626620988793,
                    0.00395772579148998, 0.0052104674072113, 0.00679148461684282,
                    0.00876415024678427, 0.0111972651474214, 0.0141635188708006,
                    0.0177372964231157, 0.0219917979902136, 0.026995483256594, 0.0328079073873383,
                    0.0394750791504471, 0.0470245386884435, 0.0554604173397278, 0.0647587978329459,
                    0.0748637328178725, 0.0856842960239037, 0.0970930274916065, 0.108926088516275,
                    0.120985362259572, 0.133042624949377, 0.144845776380741, 0.156126966683381,
                    0.1666123014459, 0.17603266338215, 0.184135070151662, 0.190693907730262,
                    0.195521346987728, 0.198476273738506, 0.199471140200716, 0.198476273738506,
                    0.195521346987728, 0.190693907730262, 0.184135070151662, 0.17603266338215,
                    0.1666123014459, 0.156126966683381, 0.144845776380741, 0.133042624949377,
                    0.120985362259572, 0.108926088516275, 0.0970930274916065, 0.0856842960239036,
                    0.0748637328178724, 0.0647587978329459, 0.0554604173397277, 0.0470245386884435,
                    0.039475079150447, 0.0328079073873383, 0.026995483256594, 0.0219917979902136,
                    0.0177372964231157, 0.0141635188708006, 0.0111972651474214, 0.00876415024678427,
                    0.00679148461684282, 0.00521046740721128, 0.00395772579148997,
                    0.00297626620988792, 0.002215924205969, 0.00163340952809996,
                    0.00119204410073242, 0.000861284469526838, 0.000616109584236509,
                    0.00043634134752288, 0.000305950965056886, 0.000212390135275375,
                    0.00014597346289573, 9.93277356963862e-05, 6.69151128824427e-05,
                    4.46308285885662e-05, 2.94715338782698e-05, 1.92675983710435e-05,
                    1.24712356450268e-05, 7.99187055345274e-06
                },
                new[]
                {
                    1.89895624658877e-08, 3.33204484854285e-08, 5.79013403996459e-08,
                    9.96442631693347e-08, 1.6982674071476e-07, 2.86651571879194e-07,
                    4.79183276590319e-07, 7.93328151975595e-07, 1.30080745391728e-06,
                    2.11245470250285e-06, 3.39767312473006e-06, 5.41254390770385e-06,
                    8.53990547099181e-06, 1.33457490159063e-05, 2.06575069125468e-05,
                    3.16712418331199e-05, 4.80963440176027e-05, 7.23480439251201e-05,
                    0.000107799733477388, 0.000159108590157534, 0.000232629079035525,
                    0.000336929265676881, 0.000483424142383777, 0.000687137937915849,
                    0.000967603213218358, 0.00134989803163009, 0.00186581330038404,
                    0.00255513033042793, 0.00346697380304067, 0.00466118802371875,
                    0.00620966532577613, 0.00819753592459613, 0.0107241100216758,
                    0.0139034475134986, 0.0178644205628166, 0.0227501319481792, 0.0287165598160018,
                    0.0359303191129258, 0.0445654627585431, 0.054799291699558, 0.0668072012688581,
                    0.0807566592337711, 0.0968004845856104, 0.115069670221708, 0.135666060946383,
                    0.158655253931457, 0.18406012534676, 0.211855398583397, 0.241963652223073,
                    0.274253117750074, 0.308537538725987, 0.344578258389676, 0.382088577811047,
                    0.420740290560897, 0.460172162722971, 0.5, 0.539827837277029,
                    0.579259709439103, 0.617911422188953, 0.655421741610324, 0.691462461274013,
                    0.725746882249927, 0.758036347776927, 0.788144601416603, 0.815939874653241,
                    0.841344746068543, 0.864333939053617, 0.884930329778292, 0.90319951541439,
                    0.919243340766229, 0.933192798731142, 0.945200708300442, 0.955434537241457,
                    0.964069680887074, 0.971283440183998, 0.977249868051821, 0.982135579437183,
                    0.986096552486501, 0.989275889978324, 0.991802464075404, 0.993790334674224,
                    0.995338811976281, 0.996533026196959, 0.997444869669572, 0.998134186699616,
                    0.99865010196837, 0.999032396786782, 0.999312862062084, 0.999516575857616,
                    0.999663070734323, 0.999767370920964, 0.999840891409842, 0.999892200266523,
                    0.999927651956075, 0.999951903655982, 0.999968328758167, 0.999979342493088,
                    0.999986654250984, 0.999991460094529, 0.999994587456092, 0.999996602326875
                },
                DefaultProbs,
                new[]
                {
                    double.NegativeInfinity, -3.65269574808168, -3.10749782126365, -2.7615872163025, -2.50137214250434,
                    -2.28970725390295, -2.10954718919371, -1.95158205635834, -1.81014312061926,
                    -1.68151006738043, -1.5631031310892, -1.45305624007322, -1.34997358413218,
                    -1.2527822580776, -1.16063868162991, -1.07286677898758, -0.988915766419506,
                    -0.908330506292388, -0.830730175685628, -0.755792590102457, -0.683242467145828,
                    -0.612842494036481, -0.54438642837737, -0.477693698370427, -0.412605125680175,
                    -0.348979500392163, -0.286690810785834, -0.225625982033254, -0.165683014542432,
                    -0.106769439111346, -0.0488010254160813, 0.0082993053050936,
                    0.0646024017709838, 0.120173668653532, 0.175073741117191, 0.229359067184865,
                    0.283082413497613, 0.336293307126367, 0.389038423801205, 0.441361931105092,
                    0.4933057937284, 0.544910046717701, 0.596213041716299, 0.647251670438277,
                    0.698061569006446, 0.748677306289852, 0.79913255897706, 0.84946027580034,
                    0.899692833070533, 0.949862183482578, 1, 1.05013781651742, 1.10030716692947,
                    1.15053972419966, 1.20086744102294, 1.25132269371015, 1.30193843099355,
                    1.35274832956172, 1.4037869582837, 1.4550899532823, 1.5066942062716,
                    1.55863806889491, 1.61096157619879, 1.66370669287363, 1.71691758650239,
                    1.77064093281514, 1.82492625888281, 1.87982633134647, 1.93539759822902,
                    1.99170069469491, 2.04880102541608, 2.10676943911135, 2.16568301454243,
                    2.22562598203325, 2.28669081078583, 2.34897950039216, 2.41260512568017,
                    2.47769369837043, 2.54438642837737, 2.61284249403648, 2.68324246714583,
                    2.75579259010246, 2.83073017568563, 2.90833050629239, 2.98891576641951,
                    3.07286677898758, 3.16063868162991, 3.2527822580776, 3.34997358413218,
                    3.45305624007322, 3.5631031310892, 3.68151006738043, 3.81014312061927,
                    3.95158205635834, 4.10954718919371, 4.28970725390295, 4.50137214250434,
                    4.7615872163025, 5.10749782126364, 5.65269574808168, double.PositiveInfinity
                })
        };

        [UsedImplicitly]
        public static TheoryData<string> TestDataKeys = TheoryDataHelper.Create(TestDataList.Select(it => it.Distribution.ToString()));

        [Theory]
        [MemberData(nameof(TestDataKeys))]
        public void NormalDistributionTest([NotNull] string testKey)
        {
            Check(TestDataList.First(it => it.Distribution.ToString() == testKey));
        }
    }
}