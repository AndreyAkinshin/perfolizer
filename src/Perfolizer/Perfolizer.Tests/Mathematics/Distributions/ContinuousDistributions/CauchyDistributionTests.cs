using JetBrains.Annotations;
using Perfolizer.Mathematics.Distributions.ContinuousDistributions;
using Perfolizer.Tests.Common;
using Perfolizer.Tests.Infra;

namespace Perfolizer.Tests.Mathematics.Distributions.ContinuousDistributions;

public class CauchyDistributionTests: DistributionTestsBase
{
    public CauchyDistributionTests(ITestOutputHelper output) : base(output)
    {
    }

    private static readonly double[] DefaultX =
    {
        -5, -4.9, -4.8, -4.7, -4.6, -4.5, -4.4, -4.3, -4.2, -4.1, -4, 
        -3.9, -3.8, -3.7, -3.6, -3.5, -3.4, -3.3, -3.2, -3.1, -3, -2.9, 
        -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1, -2, -1.9, -1.8, 
        -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1, -1, -0.9, -0.8, -0.7, 
        -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, 0, 0.1, 0.2, 0.3, 0.4, 0.5, 
        0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 
        1.9, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3, 3.1, 
        3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4, 4.1, 4.2, 4.3, 4.4, 
        4.5, 4.6, 4.7, 4.8, 4.9, 5
    };
        
    private static readonly List<TestData> TestDataList = new()
    {
        new TestData(new CauchyDistribution(),
            DefaultX,
            new[]
            {
                0.0122426879301458, 0.0127273045255414, 0.0132408438512392, 
                0.0137856165519182, 0.0143641645389797, 0.0149792887615901, 0.0156340808538208, 
                0.0163319592705896, 0.0170767106321776, 0.0178725371243004, 0.0187241109519877, 
                0.0196366370255269, 0.0206159252709709, 0.0216684742126474, 0.0228015677782085, 
                0.0240233876365125, 0.0253431438044419, 0.0267712267606216, 0.0283193848917963, 
                0.0300009317798106, 0.0318309886183791, 0.0338267679260139, 0.0360079056768994, 
                0.0383968499618565, 0.0410193152298699, 0.0439048118874194, 0.0470872612697915, 
                0.0506057052756424, 0.0545051174972244, 0.0588373172243606, 0.0636619772367581, 
                0.0690476976537507, 0.0750730863641016, 0.0818277342374783, 0.0894128893774693, 
                0.0979415034411664, 0.10753712371074, 0.118330812707729, 0.130454871386799, 
                0.144031622707598, 0.159154943091895, 0.175861815571155, 0.194091394014507, 
                0.213630796096504, 0.234051386899846, 0.254647908947033, 0.274405074296371, 
                0.292027418517239, 0.306067198253645, 0.315158303152268, 0.318309886183791, 
                0.315158303152268, 0.306067198253645, 0.292027418517239, 0.274405074296371, 
                0.254647908947033, 0.234051386899846, 0.213630796096504, 0.194091394014506, 
                0.175861815571155, 0.159154943091895, 0.144031622707598, 0.130454871386799, 
                0.118330812707729, 0.10753712371074, 0.0979415034411664, 0.0894128893774692, 
                0.0818277342374783, 0.0750730863641015, 0.0690476976537507, 0.0636619772367581, 
                0.0588373172243606, 0.0545051174972244, 0.0506057052756424, 0.0470872612697915, 
                0.0439048118874194, 0.0410193152298699, 0.0383968499618565, 0.0360079056768994, 
                0.0338267679260139, 0.0318309886183791, 0.0300009317798106, 0.0283193848917963, 
                0.0267712267606216, 0.0253431438044419, 0.0240233876365125, 0.0228015677782085, 
                0.0216684742126474, 0.0206159252709709, 0.0196366370255269, 0.0187241109519877, 
                0.0178725371243004, 0.0170767106321776, 0.0163319592705896, 0.0156340808538208, 
                0.0149792887615901, 0.0143641645389797, 0.0137856165519182, 0.0132408438512392, 
                0.0127273045255414, 0.0122426879301458
            },
            new[]
            {
                0.0628329581890012, 0.0640812258535817, 0.0653793829556703, 
                0.066730435479808, 0.0681376318216245, 0.069604487273064, 0.0711348114738153, 
                0.0727327392463714, 0.0744027652986172, 0.076149783355999, 0.0779791303773693, 
                0.07989663661717, 0.0819086824248374, 0.0840222628239476, 0.0862450610930792, 
                0.0885855327829047, 0.0910530018557488, 0.0936577709318793, 0.0964112479792296, 
                0.0993260921991186, 0.102416382349567, 0.105697811319826, 0.109187911433629, 
                0.11290631572035, 0.116875061252343, 0.121118941590843, 0.125665916378002, 
                0.130547587088623, 0.135799748780092, 0.141463028121509, 0.147583617650433, 
                0.154214114450333, 0.161414467217095, 0.169253027330333, 0.177807684489353, 
                0.187167041810999, 0.197431543288747, 0.208714400160153, 0.221142061623696, 
                0.234853827811632, 0.25, 0.266737708356574, 0.285223287477277, 
                0.305599887785785, 0.327979130377369, 0.352416382349567, 0.378881058409157, 
                0.407226420922258, 0.437167041810999, 0.468274482569447, 0.5, 
                0.531725517430554, 0.562832958189001, 0.592773579077743, 0.621118941590843, 
                0.647583617650433, 0.672020869622631, 0.694400112214215, 0.714776712522723, 
                0.733262291643426, 0.75, 0.765146172188368, 0.778857938376304, 
                0.791285599839847, 0.802568456711253, 0.812832958189001, 0.822192315510647, 
                0.830746972669667, 0.838585532782905, 0.845785885549667, 0.852416382349567, 
                0.858536971878491, 0.864200251219908, 0.869452412911377, 0.874334083621998, 
                0.878881058409157, 0.883124938747657, 0.88709368427965, 0.890812088566371, 
                0.894302188680174, 0.897583617650433, 0.900673907800881, 0.90358875202077, 
                0.906342229068121, 0.908946998144251, 0.911414467217095, 0.913754938906921, 
                0.915977737176052, 0.918091317575163, 0.92010336338283, 0.922020869622631, 
                0.923850216644001, 0.925597234701383, 0.927267260753629, 0.928865188526185, 
                0.930395512726936, 0.931862368178376, 0.933269564520192, 0.93462061704433, 
                0.935918774146418, 0.937167041810999
            },
            DefaultProbs,
            new[]
            {
                double.NegativeInfinity, -31.820515953774, -15.8945448438653, -10.5788949934056, 
                -7.91581508830583, -6.31375151467504, -5.24218358111318, -4.47374282921155, 
                -3.89474285492986, -3.44202257666922, -3.07768353717525, -2.77760685391498, 
                -2.52571168944731, -2.31086365388241, -2.1251081731572, -1.96261050550515, 
                -1.81899324728107, -1.69090765578501, -1.57574785996865, -1.47145531581997, 
                -1.37638192047117, -1.28919223178507, -1.20879235040961, -1.13427734925541, 
                -1.06489184032479, -1, -0.939062505817492, -0.881618592363189, 
                -0.827271945972475, -0.775679511049613, -0.726542528005361, -0.679599298224527, 
                -0.634619297544148, -0.591398351399471, -0.54975465219277, -0.509525449494429, 
                -0.470564281212251, -0.432738642247426, -0.395928008797721, -0.360022153095757, 
                -0.324919696232906, -0.290526856731916, -0.256756360367727, -0.223526482897149, 
                -0.190760202218567, -0.158384440324536, -0.126329378446108, -0.094527831179282, 
                -0.0629146672536499, -0.0314262660433513, 0, 0.0314262660433513, 
                0.0629146672536499, 0.0945278311792822, 0.126329378446108, 0.158384440324537, 
                0.190760202218567, 0.223526482897149, 0.256756360367727, 0.290526856731916, 
                0.324919696232906, 0.360022153095757, 0.395928008797721, 0.432738642247426, 
                0.470564281212251, 0.509525449494429, 0.54975465219277, 0.591398351399471, 
                0.634619297544148, 0.679599298224527, 0.726542528005361, 0.775679511049613, 
                0.827271945972475, 0.881618592363189, 0.939062505817492, 1, 1.06489184032479, 
                1.13427734925541, 1.20879235040961, 1.28919223178507, 1.37638192047117, 
                1.47145531581997, 1.57574785996865, 1.69090765578501, 1.81899324728107, 
                1.96261050550515, 2.1251081731572, 2.31086365388241, 2.52571168944731, 
                2.77760685391498, 3.07768353717525, 3.44202257666922, 3.89474285492986, 
                4.47374282921156, 5.24218358111318, 6.31375151467505, 7.91581508830582, 
                10.5788949934056, 15.8945448438653, 31.8205159537739, double.PositiveInfinity
            }),
        new TestData(new CauchyDistribution(1, 2),
            DefaultX,
            new[]
            {
                0.0159154943091895, 0.0164034983861783, 0.0169133839630069, 
                0.0174464174395062, 0.0180039528384497, 0.0185874386092724, 0.0191984249809283, 
                0.0198385719030097, 0.020509657614935, 0.0212135878829584, 0.0219524059437097, 
                0.0227283031905598, 0.0235436306348958, 0.0244009111677877, 0.0253028526378212, 
                0.0262523617471168, 0.0272525587486122, 0.0283067929020712, 0.0294186586121803, 
                0.0305920121272264, 0.0318309886183791, 0.033140019384049, 0.0345238488268753, 
                0.035987550727393, 0.0375365431820508, 0.0391766013764666, 0.0409138671187392, 
                0.0427548537520202, 0.0447064446887347, 0.0467758833480956, 0.0489707517205832, 
                0.0512989341150348, 0.05376856185537, 0.0563879337792366, 0.0591654063538644, 
                0.0621092460846421, 0.0652274356933997, 0.068527424366801, 0.0720158113537988, 
                0.0756979515300335, 0.0795774715459477, 0.0836556862506678, 0.0879309077855775, 
                0.0923976447558173, 0.0970456970072533, 0.101859163578813, 0.106815398048252, 
                0.11188396702418, 0.117025693449923, 0.122191894888211, 0.127323954473516, 
                0.132353383028603, 0.137202537148186, 0.141786140839105, 0.14601370925862, 
                0.149792887615901, 0.153033599126822, 0.155652756080093, 0.157579151576134, 
                0.158758047971965, 0.159154943091895, 0.158758047971965, 0.157579151576134, 
                0.155652756080093, 0.153033599126822, 0.149792887615901, 0.14601370925862, 
                0.141786140839105, 0.137202537148186, 0.132353383028603, 0.127323954473516, 
                0.122191894888211, 0.117025693449923, 0.111883967024179, 0.106815398048252, 
                0.101859163578813, 0.0970456970072532, 0.0923976447558173, 0.0879309077855775, 
                0.0836556862506677, 0.0795774715459477, 0.0756979515300335, 0.0720158113537988, 
                0.068527424366801, 0.0652274356933997, 0.0621092460846421, 0.0591654063538644, 
                0.0563879337792366, 0.05376856185537, 0.0512989341150347, 0.0489707517205832, 
                0.0467758833480956, 0.0447064446887346, 0.0427548537520202, 0.0409138671187392, 
                0.0391766013764666, 0.0375365431820508, 0.0359875507273929, 0.0345238488268753, 
                0.033140019384049, 0.0318309886183791
            },
            new[]
            {
                0.102416382349567, 0.104032154695959, 0.105697811319826, 0.107415602987925, 
                0.109187911433629, 0.111017258455, 0.11290631572035, 0.114857915338188, 
                0.116875061252343, 0.118960941527065, 0.121118941590843, 0.12335265851143, 
                0.125665916378002, 0.128062782869295, 0.130547587088623, 0.133124938747657, 
                0.135799748780092, 0.13857725146347, 0.141463028121509, 0.144463032469508, 
                0.147583617650433, 0.150831564987684, 0.154214114450333, 0.157738996785461, 
                0.161414467217095, 0.165249340538568, 0.169253027330333, 0.173435570913035, 
                0.177807684489353, 0.18238078773007, 0.187167041810999, 0.192179381597277, 
                0.197431543288747, 0.20293808537214, 0.208714400160153, 0.214776712522723, 
                0.221142061623696, 0.227828260564279, 0.234853827811632, 0.242237883181687, 
                0.25, 0.25816000396881, 0.266737708356574, 0.275752574593904, 
                0.285223287477277, 0.295167235300867, 0.305599887785785, 0.316534069134463, 
                0.327979130377369, 0.339940034761261, 0.352416382349567, 0.365401414900255, 
                0.378881058409157, 0.392833076560063, 0.407226420922258, 0.422020869622631, 
                0.437167041810999, 0.45260685772251, 0.468274482569447, 0.484097748743824, 
                0.5, 0.515902251256177, 0.531725517430554, 0.54739314227749, 
                0.562832958189001, 0.577979130377369, 0.592773579077742, 0.607166923439938, 
                0.621118941590843, 0.634598585099745, 0.647583617650433, 0.660059965238739, 
                0.672020869622631, 0.683465930865537, 0.694400112214215, 0.704832764699133, 
                0.714776712522723, 0.724247425406096, 0.733262291643426, 0.74183999603119, 
                0.75, 0.757762116818313, 0.765146172188368, 0.772171739435721, 
                0.778857938376304, 0.785223287477277, 0.791285599839847, 0.79706191462786, 
                0.802568456711253, 0.807820618402723, 0.812832958189001, 0.81761921226993, 
                0.822192315510647, 0.826564429086965, 0.830746972669667, 0.834750659461432, 
                0.838585532782905, 0.842261003214539, 0.845785885549667, 0.849168435012316, 
                0.852416382349567
            },
            DefaultProbs,
            new[]
            {
                double.NegativeInfinity, -62.6410319075479, -30.7890896877306, -20.1577899868113, 
                -14.8316301766117, -11.6275030293501, -9.48436716222635, -7.94748565842311, 
                -6.78948570985972, -5.88404515333844, -5.15536707435051, -4.55521370782995, 
                -4.05142337889461, -3.62172730776482, -3.2502163463144, -2.9252210110103, 
                -2.63798649456213, -2.38181531157002, -2.1514957199373, -1.94291063163994, 
                -1.75276384094235, -1.57838446357013, -1.41758470081922, -1.26855469851081, 
                -1.12978368064958, -1, -0.878125011634984, -0.763237184726378, 
                -0.654543891944951, -0.551359022099227, -0.453085056010722, -0.359198596449053, 
                -0.269238595088296, -0.182796702798942, -0.0995093043855397, 
                -0.0190508989888578, 0.0588714375754971, 0.134522715505148, 0.208143982404557, 
                0.279955693808487, 0.350160607534187, 0.418946286536167, 0.486487279264546, 
                0.552947034205701, 0.618479595562866, 0.683231119350927, 0.747341243107784, 
                0.810944337641436, 0.8741706654927, 0.937147467913298, 1, 1.0628525320867, 
                1.1258293345073, 1.18905566235856, 1.25265875689222, 1.31676888064907, 
                1.38152040443713, 1.4470529657943, 1.51351272073545, 1.58105371346383, 
                1.64983939246581, 1.72004430619151, 1.79185601759544, 1.86547728449485, 
                1.9411285624245, 2.01905089898886, 2.09950930438554, 2.18279670279894, 
                2.2692385950883, 2.35919859644905, 2.45308505601072, 2.55135902209923, 
                2.65454389194495, 2.76323718472638, 2.87812501163498, 3, 3.12978368064958, 
                3.26855469851081, 3.41758470081922, 3.57838446357013, 3.75276384094235, 
                3.94291063163994, 4.1514957199373, 4.38181531157002, 4.63798649456213, 
                4.9252210110103, 5.2502163463144, 5.62172730776482, 6.05142337889461, 
                6.55521370782995, 7.15536707435051, 7.88404515333844, 8.78948570985972, 
                9.94748565842312, 11.4843671622264, 13.6275030293501, 16.8316301766116, 
                22.1577899868113, 32.7890896877306, 64.6410319075479, double.PositiveInfinity
            }),
    };

    [UsedImplicitly]
    public static TheoryData<string> TestDataKeys = TheoryDataHelper.Create(TestDataList.Select(it => it.Distribution.ToString()!));

    [Theory]
    [MemberData(nameof(TestDataKeys))]
    public void CauchyDistributionTest(string testKey)
    {
        Check(TestDataList.First(it => it.Distribution.ToString() == testKey));
    }
}