using JetBrains.Annotations;
using Perfolizer.Mathematics.QuantileEstimators;
using Perfolizer.Tests.Infra;
using Pragmastat;

namespace Perfolizer.SimulationTests.QuantileEstimators;

public class SampleQuantileEstimatorTests : QuantileEstimatorTests
{
    public SampleQuantileEstimatorTests(ITestOutputHelper output) : base(output)
    {
    }

    private static readonly IDictionary<string, TestData> TestDataMap = new Dictionary<string, TestData>
    {
        {
            "Case1", new TestData(
                new[] {0.0, 25, 50, 75, 100},
                new Probability[]
                    {0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1},
                new[] {0.0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100}
            )
        },
        {
            "Case2", new TestData(
                new[]
                {
                    1.0013577451644, -0.229615782737675, -0.819725857036057, -0.948076620842995,
                    -0.24815560320013, 0.540179349040059, -0.00755075251704763, 0.043492412011478,
                    1.54176214245486, 0.638809676091943, 1.28423635004994, -1.96047080389561,
                    -0.0281675942327678, 0.511006704518357, -0.0804861044889514,
                    1.30279218612655, 0.243957634202458, -0.144015544776309, -0.650240004427951,
                    0.162775308850371, -0.375029668356726, 0.340877684969295, -1.31645147885116,
                    0.360699783652576, 0.696496420066714, 0.150342957602688, -0.74231623060989,
                    -0.0666252274544248, 0.465499487354232, -0.285085528006817
                },
                new Probability[]
                    {0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1},
                new[]
                {
                    -1.96047080389561, -1.15068279274748, -0.832560933416751, -0.710089551446212,
                    -0.430071735570971, -0.275853046805146, -0.235177728876411, -0.134486128733206,
                    -0.0721695782682354, -0.0271367521469817, 0.0179708297472152,
                    0.145000430323128, 0.195248238991206, 0.32633967735427, 0.392139694763073,
                    0.499629900227326, 0.559905414450436, 0.676306059675544, 1.02964560565295,
                    1.29444205989207, 1.54176214245486
                }
            )
        },
        {
            "Case3", new TestData(
                new[]
                {
                    1.24149437336876, -1.64419894843023, -1.70660998047448, 0.411145889012774, -1.8310962210992
                },
                new Probability[]
                {
                    0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1,
                    0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.21,
                    0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3, 0.31, 0.32,
                    0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4, 0.41, 0.42, 0.43,
                    0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5, 0.51, 0.52, 0.53, 0.54,
                    0.55, 0.56, 0.57, 0.58, 0.59, 0.6, 0.61, 0.62, 0.63, 0.64, 0.65,
                    0.66, 0.67, 0.68, 0.69, 0.7, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76,
                    0.77, 0.78, 0.79, 0.8, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87,
                    0.88, 0.89, 0.9, 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98,
                    0.99, 1
                },
                new[]
                {
                    -1.8310962210992, -1.82611677147421, -1.82113732184923, -1.81615787222424,
                    -1.81117842259925, -1.80619897297426, -1.80121952334927, -1.79624007372428,
                    -1.79126062409929, -1.7862811744743, -1.78130172484931, -1.77632227522432,
                    -1.77134282559933, -1.76636337597435, -1.76138392634936, -1.75640447672437,
                    -1.75142502709938, -1.74644557747439, -1.7414661278494, -1.73648667822441,
                    -1.73150722859942, -1.72652777897443, -1.72154832934944, -1.71656887972446,
                    -1.71158943009947, -1.70660998047448, -1.70411353919271, -1.70161709791094,
                    -1.69912065662917, -1.6966242153474, -1.69412777406563, -1.69163133278386,
                    -1.68913489150209, -1.68663845022032, -1.68414200893855, -1.68164556765678,
                    -1.67914912637501, -1.67665268509324, -1.67415624381147, -1.6716598025297,
                    -1.66916336124793, -1.66666691996616, -1.66417047868439, -1.66167403740262,
                    -1.65917759612085, -1.65668115483908, -1.65418471355731, -1.65168827227554,
                    -1.64919183099377, -1.646695389712, -1.64419894843023, -1.56198515493251,
                    -1.47977136143479, -1.39755756793707, -1.31534377443935, -1.23312998094163,
                    -1.15091618744391, -1.06870239394619, -0.986488600448466, -0.904274806950746,
                    -0.822061013453026, -0.739847219955306, -0.657633426457586, -0.575419632959866,
                    -0.493205839462146, -0.410992045964426, -0.328778252466706, -0.246564458968985,
                    -0.164350665471265, -0.0821368719735452, 7.69215241748222e-05,
                    0.0822907150218941, 0.164504508519614, 0.246718302017334, 0.328932095515054,
                    0.411145889012774, 0.444359828387014, 0.477573767761253, 0.510787707135493,
                    0.544001646509732, 0.577215585883971, 0.610429525258211, 0.64364346463245,
                    0.67685740400669, 0.710071343380928, 0.743285282755168, 0.776499222129407,
                    0.809713161503647, 0.842927100877886, 0.876141040252126, 0.909354979626365,
                    0.942568919000605, 0.975782858374843, 1.00899679774908, 1.04221073712332,
                    1.07542467649756, 1.1086386158718, 1.14185255524604, 1.17506649462028,
                    1.20828043399452, 1.24149437336876
                }
            )
        },
        {
            "Case4", new TestData(
                new[]
                {
                    -0.043776827701856, -1.83173062250113, -0.00262031578445295,
                    0.35135158734807, 0.0124008692328855, 0.804722446841616, 0.32829512682192,
                    -0.412600063993969, 0.43023347314408, 2.22566237817195, -1.43667678904493,
                    -0.815417077672286, -1.25114132959598, 1.860949861493, -1.74052207538404,
                    -0.334563032374693, 0.806576188845978, 0.574644711051252, 0.327332450991332,
                    0.712622954460878, -0.580016134307437, -0.618717182453939, 0.18740525165911,
                    1.89537110196101, 0.989631535269322, -0.997280317992594, 1.85545139964613,
                    -1.19950216138767, -2.16858562187116, -0.664932543998084, -0.220570291696622,
                    -0.262337474610413, 0.893422028281752, 1.03452972116359, 0.578405828201511,
                    0.785647411794687, 0.380771310383994, 1.54839725981775, 0.594285315287308,
                    0.0583480809961187, 1.64972234666586, 0.490931719138483, 0.74651389034522,
                    0.121346171753156, -0.086989881925353, 1.66999834984586, 1.05859258407607,
                    0.0500299248345132, 0.739025405781617, -0.0786660010451375, -0.174983325631456,
                    -0.306158424299288, 0.711971341973206, 0.168836353081191, 0.531507110298432,
                    -0.304806313766179, -1.51252582345345, 0.776011286652181, 0.57414414527779,
                    -0.905790480830737, 0.141620538879256, 0.234599382650371, -0.570138707478075,
                    -0.810570721636217, -0.226747828106258, -0.0394220435565237,
                    -1.55060661029489, -1.3338934280281, -0.685990144477635, -0.296671491720494,
                    -0.438063618313897, 0.636234641908336, -1.06809040852729, -0.086421331731215,
                    1.92020602268982, 0.595031931771708, 0.198611628830248, -0.635831751851919,
                    0.243220103881828, 0.66260970094913, 1.3152511478334, -1.34446849909783,
                    1.71834880657051, 1.03856767591755, 0.141363642247333, 1.93117560724812,
                    0.634810260941762, 1.47134838672404, 1.67666928327214, 0.0236848921198921,
                    0.409452850236442, 2.97449513774209, 0.317236994920069, 0.278339960122484,
                    0.158031849965435, -0.468205030721617, 0.946534680648184, 0.00159610242146966,
                    0.426582470433524, 0.020253986456755
                },
                new Probability[]
                {
                    0, 0.001, 0.002, 0.003, 0.004, 0.005, 0.006, 0.007, 0.008,
                    0.009, 0.01, 0.011, 0.012, 0.013, 0.014, 0.015, 0.016, 0.017,
                    0.018, 0.019, 0.02, 0.021, 0.022, 0.023, 0.024, 0.025, 0.026,
                    0.027, 0.028, 0.029, 0.03, 0.031, 0.032, 0.033, 0.034, 0.035,
                    0.036, 0.037, 0.038, 0.039, 0.04, 0.041, 0.042, 0.043, 0.044,
                    0.045, 0.046, 0.047, 0.048, 0.049, 0.05, 0.051, 0.052, 0.053,
                    0.054, 0.055, 0.056, 0.057, 0.058, 0.059, 0.06, 0.061, 0.062,
                    0.063, 0.064, 0.065, 0.066, 0.067, 0.068, 0.069, 0.07, 0.071,
                    0.072, 0.073, 0.074, 0.075, 0.076, 0.077, 0.078, 0.079, 0.08,
                    0.081, 0.082, 0.083, 0.084, 0.085, 0.086, 0.087, 0.088, 0.089,
                    0.09, 0.091, 0.092, 0.093, 0.094, 0.095, 0.096, 0.097, 0.098,
                    0.099, 0.1, 0.101, 0.102, 0.103, 0.104, 0.105, 0.106, 0.107,
                    0.108, 0.109, 0.11, 0.111, 0.112, 0.113, 0.114, 0.115, 0.116,
                    0.117, 0.118, 0.119, 0.12, 0.121, 0.122, 0.123, 0.124, 0.125,
                    0.126, 0.127, 0.128, 0.129, 0.13, 0.131, 0.132, 0.133, 0.134,
                    0.135, 0.136, 0.137, 0.138, 0.139, 0.14, 0.141, 0.142, 0.143,
                    0.144, 0.145, 0.146, 0.147, 0.148, 0.149, 0.15, 0.151, 0.152,
                    0.153, 0.154, 0.155, 0.156, 0.157, 0.158, 0.159, 0.16, 0.161,
                    0.162, 0.163, 0.164, 0.165, 0.166, 0.167, 0.168, 0.169, 0.17,
                    0.171, 0.172, 0.173, 0.174, 0.175, 0.176, 0.177, 0.178, 0.179,
                    0.18, 0.181, 0.182, 0.183, 0.184, 0.185, 0.186, 0.187, 0.188,
                    0.189, 0.19, 0.191, 0.192, 0.193, 0.194, 0.195, 0.196, 0.197,
                    0.198, 0.199, 0.2, 0.201, 0.202, 0.203, 0.204, 0.205, 0.206,
                    0.207, 0.208, 0.209, 0.21, 0.211, 0.212, 0.213, 0.214, 0.215,
                    0.216, 0.217, 0.218, 0.219, 0.22, 0.221, 0.222, 0.223, 0.224,
                    0.225, 0.226, 0.227, 0.228, 0.229, 0.23, 0.231, 0.232, 0.233,
                    0.234, 0.235, 0.236, 0.237, 0.238, 0.239, 0.24, 0.241, 0.242,
                    0.243, 0.244, 0.245, 0.246, 0.247, 0.248, 0.249, 0.25, 0.251,
                    0.252, 0.253, 0.254, 0.255, 0.256, 0.257, 0.258, 0.259, 0.26,
                    0.261, 0.262, 0.263, 0.264, 0.265, 0.266, 0.267, 0.268, 0.269,
                    0.27, 0.271, 0.272, 0.273, 0.274, 0.275, 0.276, 0.277, 0.278,
                    0.279, 0.28, 0.281, 0.282, 0.283, 0.284, 0.285, 0.286, 0.287,
                    0.288, 0.289, 0.29, 0.291, 0.292, 0.293, 0.294, 0.295, 0.296,
                    0.297, 0.298, 0.299, 0.3, 0.301, 0.302, 0.303, 0.304, 0.305,
                    0.306, 0.307, 0.308, 0.309, 0.31, 0.311, 0.312, 0.313, 0.314,
                    0.315, 0.316, 0.317, 0.318, 0.319, 0.32, 0.321, 0.322, 0.323,
                    0.324, 0.325, 0.326, 0.327, 0.328, 0.329, 0.33, 0.331, 0.332,
                    0.333, 0.334, 0.335, 0.336, 0.337, 0.338, 0.339, 0.34, 0.341,
                    0.342, 0.343, 0.344, 0.345, 0.346, 0.347, 0.348, 0.349, 0.35,
                    0.351, 0.352, 0.353, 0.354, 0.355, 0.356, 0.357, 0.358, 0.359,
                    0.36, 0.361, 0.362, 0.363, 0.364, 0.365, 0.366, 0.367, 0.368,
                    0.369, 0.37, 0.371, 0.372, 0.373, 0.374, 0.375, 0.376, 0.377,
                    0.378, 0.379, 0.38, 0.381, 0.382, 0.383, 0.384, 0.385, 0.386,
                    0.387, 0.388, 0.389, 0.39, 0.391, 0.392, 0.393, 0.394, 0.395,
                    0.396, 0.397, 0.398, 0.399, 0.4, 0.401, 0.402, 0.403, 0.404,
                    0.405, 0.406, 0.407, 0.408, 0.409, 0.41, 0.411, 0.412, 0.413,
                    0.414, 0.415, 0.416, 0.417, 0.418, 0.419, 0.42, 0.421, 0.422,
                    0.423, 0.424, 0.425, 0.426, 0.427, 0.428, 0.429, 0.43, 0.431,
                    0.432, 0.433, 0.434, 0.435, 0.436, 0.437, 0.438, 0.439, 0.44,
                    0.441, 0.442, 0.443, 0.444, 0.445, 0.446, 0.447, 0.448, 0.449,
                    0.45, 0.451, 0.452, 0.453, 0.454, 0.455, 0.456, 0.457, 0.458,
                    0.459, 0.46, 0.461, 0.462, 0.463, 0.464, 0.465, 0.466, 0.467,
                    0.468, 0.469, 0.47, 0.471, 0.472, 0.473, 0.474, 0.475, 0.476,
                    0.477, 0.478, 0.479, 0.48, 0.481, 0.482, 0.483, 0.484, 0.485,
                    0.486, 0.487, 0.488, 0.489, 0.49, 0.491, 0.492, 0.493, 0.494,
                    0.495, 0.496, 0.497, 0.498, 0.499, 0.5, 0.501, 0.502, 0.503,
                    0.504, 0.505, 0.506, 0.507, 0.508, 0.509, 0.51, 0.511, 0.512,
                    0.513, 0.514, 0.515, 0.516, 0.517, 0.518, 0.519, 0.52, 0.521,
                    0.522, 0.523, 0.524, 0.525, 0.526, 0.527, 0.528, 0.529, 0.53,
                    0.531, 0.532, 0.533, 0.534, 0.535, 0.536, 0.537, 0.538, 0.539,
                    0.54, 0.541, 0.542, 0.543, 0.544, 0.545, 0.546, 0.547, 0.548,
                    0.549, 0.55, 0.551, 0.552, 0.553, 0.554, 0.555, 0.556, 0.557,
                    0.558, 0.559, 0.56, 0.561, 0.562, 0.563, 0.564, 0.565, 0.566,
                    0.567, 0.568, 0.569, 0.57, 0.571, 0.572, 0.573, 0.574, 0.575,
                    0.576, 0.577, 0.578, 0.579, 0.58, 0.581, 0.582, 0.583, 0.584,
                    0.585, 0.586, 0.587, 0.588, 0.589, 0.59, 0.591, 0.592, 0.593,
                    0.594, 0.595, 0.596, 0.597, 0.598, 0.599, 0.6, 0.601, 0.602,
                    0.603, 0.604, 0.605, 0.606, 0.607, 0.608, 0.609, 0.61, 0.611,
                    0.612, 0.613, 0.614, 0.615, 0.616, 0.617, 0.618, 0.619, 0.62,
                    0.621, 0.622, 0.623, 0.624, 0.625, 0.626, 0.627, 0.628, 0.629,
                    0.63, 0.631, 0.632, 0.633, 0.634, 0.635, 0.636, 0.637, 0.638,
                    0.639, 0.64, 0.641, 0.642, 0.643, 0.644, 0.645, 0.646, 0.647,
                    0.648, 0.649, 0.65, 0.651, 0.652, 0.653, 0.654, 0.655, 0.656,
                    0.657, 0.658, 0.659, 0.66, 0.661, 0.662, 0.663, 0.664, 0.665,
                    0.666, 0.667, 0.668, 0.669, 0.67, 0.671, 0.672, 0.673, 0.674,
                    0.675, 0.676, 0.677, 0.678, 0.679, 0.68, 0.681, 0.682, 0.683,
                    0.684, 0.685, 0.686, 0.687, 0.688, 0.689, 0.69, 0.691, 0.692,
                    0.693, 0.694, 0.695, 0.696, 0.697, 0.698, 0.699, 0.7, 0.701,
                    0.702, 0.703, 0.704, 0.705, 0.706, 0.707, 0.708, 0.709, 0.71,
                    0.711, 0.712, 0.713, 0.714, 0.715, 0.716, 0.717, 0.718, 0.719,
                    0.72, 0.721, 0.722, 0.723, 0.724, 0.725, 0.726, 0.727, 0.728,
                    0.729, 0.73, 0.731, 0.732, 0.733, 0.734, 0.735, 0.736, 0.737,
                    0.738, 0.739, 0.74, 0.741, 0.742, 0.743, 0.744, 0.745, 0.746,
                    0.747, 0.748, 0.749, 0.75, 0.751, 0.752, 0.753, 0.754, 0.755,
                    0.756, 0.757, 0.758, 0.759, 0.76, 0.761, 0.762, 0.763, 0.764,
                    0.765, 0.766, 0.767, 0.768, 0.769, 0.77, 0.771, 0.772, 0.773,
                    0.774, 0.775, 0.776, 0.777, 0.778, 0.779, 0.78, 0.781, 0.782,
                    0.783, 0.784, 0.785, 0.786, 0.787, 0.788, 0.789, 0.79, 0.791,
                    0.792, 0.793, 0.794, 0.795, 0.796, 0.797, 0.798, 0.799, 0.8,
                    0.801, 0.802, 0.803, 0.804, 0.805, 0.806, 0.807, 0.808, 0.809,
                    0.81, 0.811, 0.812, 0.813, 0.814, 0.815, 0.816, 0.817, 0.818,
                    0.819, 0.82, 0.821, 0.822, 0.823, 0.824, 0.825, 0.826, 0.827,
                    0.828, 0.829, 0.83, 0.831, 0.832, 0.833, 0.834, 0.835, 0.836,
                    0.837, 0.838, 0.839, 0.84, 0.841, 0.842, 0.843, 0.844, 0.845,
                    0.846, 0.847, 0.848, 0.849, 0.85, 0.851, 0.852, 0.853, 0.854,
                    0.855, 0.856, 0.857, 0.858, 0.859, 0.86, 0.861, 0.862, 0.863,
                    0.864, 0.865, 0.866, 0.867, 0.868, 0.869, 0.87, 0.871, 0.872,
                    0.873, 0.874, 0.875, 0.876, 0.877, 0.878, 0.879, 0.88, 0.881,
                    0.882, 0.883, 0.884, 0.885, 0.886, 0.887, 0.888, 0.889, 0.89,
                    0.891, 0.892, 0.893, 0.894, 0.895, 0.896, 0.897, 0.898, 0.899,
                    0.9, 0.901, 0.902, 0.903, 0.904, 0.905, 0.906, 0.907, 0.908,
                    0.909, 0.91, 0.911, 0.912, 0.913, 0.914, 0.915, 0.916, 0.917,
                    0.918, 0.919, 0.92, 0.921, 0.922, 0.923, 0.924, 0.925, 0.926,
                    0.927, 0.928, 0.929, 0.93, 0.931, 0.932, 0.933, 0.934, 0.935,
                    0.936, 0.937, 0.938, 0.939, 0.94, 0.941, 0.942, 0.943, 0.944,
                    0.945, 0.946, 0.947, 0.948, 0.949, 0.95, 0.951, 0.952, 0.953,
                    0.954, 0.955, 0.956, 0.957, 0.958, 0.959, 0.96, 0.961, 0.962,
                    0.963, 0.964, 0.965, 0.966, 0.967, 0.968, 0.969, 0.97, 0.971,
                    0.972, 0.973, 0.974, 0.975, 0.976, 0.977, 0.978, 0.979, 0.98,
                    0.981, 0.982, 0.983, 0.984, 0.985, 0.986, 0.987, 0.988, 0.989,
                    0.99, 0.991, 0.992, 0.993, 0.994, 0.995, 0.996, 0.997, 0.998,
                    0.999, 1
                },
                new[]
                {
                    -2.16858562187116, -2.13523697693353, -2.10188833199589, -2.06853968705826,
                    -2.03519104212063, -2.00184239718299, -1.96849375224536, -1.93514510730773,
                    -1.90179646237009, -1.86844781743246, -1.83509917249483, -1.82361306180771,
                    -1.81458341564311, -1.80555376947852, -1.79652412331393, -1.78749447714934,
                    -1.77846483098475, -1.76943518482016, -1.76040553865556, -1.75137589249097,
                    -1.74234624632638, -1.725518753642, -1.70671712259817, -1.68791549155435,
                    -1.66911386051052, -1.6503122294667, -1.63151059842287, -1.61270896737904,
                    -1.59390733633522, -1.57510570529139, -1.55630407424757, -1.54797903600283,
                    -1.54420903810553, -1.54043904020823, -1.53666904231093, -1.53289904441362,
                    -1.52912904651632, -1.52535904861902, -1.52158905072171, -1.51781905282441,
                    -1.51404905492711, -1.50805073042335, -1.50054167601691, -1.49303262161046,
                    -1.48552356720402, -1.47801451279758, -1.47050545839113, -1.46299640398469,
                    -1.45548734957824, -1.4479782951718, -1.44046924076536, -1.43215858283752,
                    -1.42302996213276, -1.413901341428, -1.40477272072324, -1.39564410001847,
                    -1.38651547931371, -1.37738685860895, -1.36825823790419, -1.35912961719942,
                    -1.35000099649466, -1.34405607132612, -1.34300913929021, -1.34196220725431,
                    -1.34091527521841, -1.3398683431825, -1.3388214111466, -1.3377744791107,
                    -1.33672754707479, -1.33568061503889, -1.33463368300299, -1.33149361717357,
                    -1.32330115942879, -1.31510870168401, -1.30691624393923, -1.29872378619445,
                    -1.29053132844967, -1.28233887070489, -1.27414641296011, -1.26595395521533,
                    -1.25776149747055, -1.25016018540002, -1.2450479077474, -1.23993563009478,
                    -1.23482335244216, -1.22971107478953, -1.22459879713691, -1.21948651948429,
                    -1.21437424183167, -1.20926196417904, -1.20414968652642, -1.19831945561193,
                    -1.18530969207875, -1.17229992854557, -1.1592901650124, -1.14628040147922,
                    -1.13327063794604, -1.12026087441286, -1.10725111087968, -1.0942413473465,
                    -1.08123158381333, -1.06822182028015, -1.06115101965489, -1.05414082069195,
                    -1.04713062172902, -1.04012042276608, -1.03311022380315, -1.02610002484021,
                    -1.01908982587728, -1.01207962691435, -1.00506942795141, -0.998059228988476,
                    -0.989229212322351, -0.980171718443327, -0.971114224564303, -0.962056730685279,
                    -0.952999236806255, -0.943941742927232, -0.934884249048208, -0.925826755169184,
                    -0.91676926129016, -0.907711767411136, -0.898741355384378, -0.889794388471691,
                    -0.880847421559005, -0.871900454646318, -0.862953487733631, -0.854006520820945,
                    -0.845059553908258, -0.836112586995571, -0.827165620082884, -0.818218653170198,
                    -0.815087525461833, -0.814607736214262, -0.814127946966692, -0.813648157719121,
                    -0.81316836847155, -0.812688579223979, -0.812208789976408, -0.811729000728837,
                    -0.811249211481267, -0.810769422233696, -0.803345048161019, -0.791011571022319,
                    -0.77867809388362, -0.766344616744921, -0.754011139606221, -0.741677662467521,
                    -0.729344185328822, -0.717010708190122, -0.704677231051423, -0.692343753912723,
                    -0.684979379654617, -0.682894677207141, -0.680809974759666, -0.67872527231219,
                    -0.676640569864714, -0.674555867417239, -0.672471164969763, -0.670386462522288,
                    -0.668301760074812, -0.666217057627336, -0.663826713896529, -0.660945735474059,
                    -0.658064757051589, -0.655183778629118, -0.652302800206648, -0.649421821784178,
                    -0.646540843361707, -0.643659864939237, -0.640778886516767, -0.637897908094296,
                    -0.635352543908775, -0.633658201538375, -0.631963859167975, -0.630269516797575,
                    -0.628575174427175, -0.626880832056776, -0.625186489686376, -0.623492147315976,
                    -0.621797804945576, -0.620103462575176, -0.618020563587302, -0.614189159820799,
                    -0.610357756054295, -0.606526352287791, -0.602694948521287, -0.598863544754783,
                    -0.59503214098828, -0.591200737221776, -0.587369333455272, -0.583537929688768,
                    -0.579937114892802, -0.578959249636695, -0.577981384380588, -0.577003519124481,
                    -0.576025653868375, -0.575047788612268, -0.574069923356161, -0.573092058100054,
                    -0.572114192843947, -0.571136327587841, -0.570158462331734, -0.560251140832699,
                    -0.550159706833809, -0.54006827283492, -0.529976838836031, -0.519885404837141,
                    -0.509793970838252, -0.499702536839363, -0.489611102840474, -0.479519668841584,
                    -0.469428234842695, -0.465582727842146, -0.462598728013781, -0.459614728185417,
                    -0.456630728357053, -0.453646728528689, -0.450662728700324, -0.44767872887196,
                    -0.444694729043596, -0.441710729215232, -0.438726729386867, -0.436102924631263,
                    -0.43358203275359, -0.431061140875917, -0.428540248998244, -0.426019357120571,
                    -0.423498465242898, -0.420977573365226, -0.418456681487553, -0.41593578960988,
                    -0.413414897732207, -0.407371582875478, -0.399645916745169, -0.391920250614861,
                    -0.384194584484552, -0.376468918354244, -0.368743252223936, -0.361017586093627,
                    -0.353291919963319, -0.345566253833011, -0.337840587702702, -0.332943969714395,
                    -0.33013191351493, -0.327319857315465, -0.324507801115999, -0.321695744916534,
                    -0.318883688717069, -0.316071632517604, -0.313259576318139, -0.310447520118674,
                    -0.307635463919209, -0.306094875104232, -0.305961016161454, -0.305827157218676,
                    -0.305693298275899, -0.305559439333121, -0.305425580390343, -0.305291721447565,
                    -0.305157862504787, -0.30502400356201, -0.304890144619232, -0.304505325350489,
                    -0.303699977967966, -0.302894630585443, -0.30208928320292, -0.301283935820397,
                    -0.300478588437875, -0.299673241055352, -0.298867893672829, -0.298062546290306,
                    -0.297257198907783, -0.295744473258522, -0.292345405564624, -0.288946337870726,
                    -0.285547270176828, -0.28214820248293, -0.278749134789032, -0.275350067095134,
                    -0.271950999401235, -0.268551931707337, -0.265152864013439, -0.261732450619842,
                    -0.258209075615931, -0.254685700612019, -0.251162325608108, -0.247638950604197,
                    -0.244115575600285, -0.240592200596374, -0.237068825592463, -0.233545450588552,
                    -0.23002207558464, -0.22670458535139, -0.226093009246836, -0.225481433142282,
                    -0.224869857037729, -0.224258280933175, -0.223646704828621, -0.223035128724067,
                    -0.222423552619513, -0.221811976514959, -0.221200400410405, -0.220588824305851,
                    -0.216193942954366, -0.211680833313915, -0.207167723673463, -0.202654614033012,
                    -0.19814150439256, -0.193628394752109, -0.189115285111658, -0.184602175471206,
                    -0.180089065830755, -0.175575956190303, -0.167415889472731, -0.158704538545827,
                    -0.149993187618923, -0.141281836692019, -0.132570485765115, -0.12385913483821,
                    -0.115147783911306, -0.106436432984402, -0.0977250820574976,
                    -0.0890137311305931, -0.0869466721105985, -0.0868903856413789,
                    -0.0868340991721592, -0.0867778127029395, -0.0867215262337199,
                    -0.0866652397645002, -0.0866089532952806, -0.0865526668260609,
                    -0.0864963803568412, -0.0864400938876216, -0.0859094799059339,
                    -0.0851417021680122, -0.0843739244300905, -0.0836061466921689,
                    -0.0828383689542471, -0.0820705912163255, -0.0813028134784038,
                    -0.0805350357404822, -0.0797672580025604, -0.0789994802646388,
                    -0.0767122073379135, -0.0732581791769288, -0.0698041510159438,
                    -0.066350122854959, -0.0628960946939741, -0.0594420665329893,
                    -0.0559880383720043, -0.0525340102110196, -0.0490799820500348,
                    -0.0456259538890501, -0.0435765076311707, -0.0431453840007828,
                    -0.0427142603703949, -0.042283136740007, -0.0418520131096191,
                    -0.0414208894792313, -0.0409897658488434, -0.0405586422184555,
                    -0.0401275185880676, -0.0396963949576797, -0.0380971813567291,
                    -0.0344538103072943, -0.0308104392578591, -0.0271670682084242,
                    -0.0235236971589891, -0.0198803261095542, -0.016236955060119,
                    -0.0125935840106842, -0.00895021296124901, -0.00530684191181413,
                    -0.00251068891109894, -0.00209326350871262, -0.0016758381063263,
                    -0.00125841270393994, -0.000840987301553617, -0.000423561899167263,
                    -6.13649678093855e-06, 0.000411288905605416, 0.00082871430799174,
                    0.00124613971037809, 0.0017689786904523, 0.00283865060478251,
                    0.00390832251911264, 0.00497799443344285, 0.00604766634777298,
                    0.00711733826210319, 0.00818701017643332, 0.00925668209076352,
                    0.0103263540050937, 0.0113960259194239, 0.0124479879362287, 0.0132254465413918,
                    0.0140029051465549, 0.014780363751718, 0.0155578223568811, 0.0163352809620442,
                    0.0171127395672072, 0.0178901981723703, 0.0186676567775334, 0.0194451153826965,
                    0.0202225739878596, 0.0205799224947531, 0.0209195821554036, 0.0212592418160542,
                    0.0215989014767048, 0.0219385611373553, 0.0222782207980059, 0.0226178804586565,
                    0.0229575401193071, 0.0232971997799576, 0.0236368594406082, 0.0259242199006349,
                    0.0285323781393825, 0.0311405363781299, 0.0337486946168773, 0.0363568528556249,
                    0.0389650110943723, 0.0415731693331199, 0.0441813275718673, 0.0467894858106147,
                    0.0493976440493622, 0.0506537865466335, 0.0514772840066325, 0.0523007814666314,
                    0.0531242789266304, 0.0539477763866293, 0.0547712738466283, 0.0555947713066273,
                    0.0564182687666262, 0.0572417662266251, 0.0580652636866241, 0.062442956895326,
                    0.0686797678802729, 0.0749165788652194, 0.0811533898501663, 0.0873902008351128,
                    0.0936270118200598, 0.0998638228050062, 0.106100633789953, 0.1123374447749,
                    0.118574255759847, 0.122447132630336, 0.124428862209259, 0.126410591788183,
                    0.128392321367106, 0.13037405094603, 0.132355780524953, 0.134337510103877,
                    0.1363192396828, 0.138300969261724, 0.140282698840647, 0.141375202595769,
                    0.14140063536233, 0.14142606812889, 0.14145150089545, 0.141476933662011,
                    0.141502366428571, 0.141527799195132, 0.141553231961692, 0.141578664728253,
                    0.141604097494813, 0.142194934767272, 0.143819654564804, 0.145444374362336,
                    0.147069094159868, 0.148693813957399, 0.150318533754931, 0.151943253552463,
                    0.153567973349995, 0.155192693147526, 0.156817412945058, 0.158301962543329,
                    0.159371608351789, 0.160441254160249, 0.161510899968709, 0.162580545777169,
                    0.163650191585628, 0.164719837394088, 0.165789483202548, 0.166859129011008,
                    0.167928774819468, 0.16911488655986, 0.170953207519074, 0.172791528478288,
                    0.174629849437502, 0.176468170396716, 0.17830649135593, 0.180144812315144,
                    0.181983133274358, 0.183821454233572, 0.185659775192786, 0.187461283544966,
                    0.188570714884909, 0.189680146224851, 0.190789577564794, 0.191899008904737,
                    0.193008440244679, 0.194117871584622, 0.195227302924565, 0.196336734264507,
                    0.19744616560445, 0.198555596944393, 0.20199447768934, 0.205557265317532,
                    0.209120052945724, 0.212682840573916, 0.216245628202109, 0.219808415830301,
                    0.223371203458493, 0.226933991086685, 0.230496778714877, 0.234059566343069,
                    0.235323523233814, 0.236176974635728, 0.237030426037642, 0.237883877439556,
                    0.23873732884147, 0.239590780243385, 0.240444231645299, 0.241297683047213,
                    0.242151134449127, 0.243004585851042, 0.245818973243637, 0.249295839011461,
                    0.252772704779286, 0.256249570547111, 0.259726436314936, 0.263203302082761,
                    0.266680167850586, 0.270157033618411, 0.273633899386236, 0.277110765154061,
                    0.280829370349529, 0.28468017679449, 0.288530983239451, 0.292381789684412,
                    0.296232596129373, 0.300083402574334, 0.303934209019295, 0.307785015464256,
                    0.311635821909217, 0.315486628354178, 0.317782149547918, 0.318781599698973,
                    0.319781049850028, 0.320780500001083, 0.321779950152138, 0.322779400303193,
                    0.323778850454248, 0.324778300605303, 0.325777750756358, 0.326777200907413,
                    0.327374808727878, 0.327470113635106, 0.327565418542335, 0.327660723449563,
                    0.327756028356791, 0.327851333264019, 0.327946638171247, 0.328041943078475,
                    0.328137247985703, 0.328232552892931, 0.329079046479809, 0.331361636071898,
                    0.333644225663986, 0.335926815256075, 0.338209404848164, 0.340491994440253,
                    0.342774584032342, 0.345057173624431, 0.34733976321652, 0.349622352808608,
                    0.352057660700932, 0.354970213281488, 0.357882765862045, 0.360795318442601,
                    0.363707871023158, 0.366620423603714, 0.369532976184271, 0.372445528764828,
                    0.375358081345384, 0.378270633925941, 0.381172851941928, 0.384012324387321,
                    0.386851796832713, 0.389691269278105, 0.392530741723498, 0.39537021416889,
                    0.398209686614282, 0.401049159059674, 0.403888631505067, 0.406728103950459,
                    0.40952136871723, 0.411217201116741, 0.412913033516252, 0.414608865915763,
                    0.416304698315275, 0.418000530714786, 0.419696363114297, 0.421392195513808,
                    0.423088027913319, 0.42478386031283, 0.426479692712341, 0.426922013685606,
                    0.427283462953951, 0.427644912222296, 0.428006361490641, 0.428367810758986,
                    0.428729260027331, 0.429090709295676, 0.429452158564021, 0.429813607832366,
                    0.430175057100711, 0.435271427561616, 0.441280553915062, 0.447289680268507,
                    0.453298806621954, 0.459307932975399, 0.465317059328845, 0.471326185682291,
                    0.477335312035737, 0.483344438389183, 0.489353564742628, 0.493893722693159,
                    0.497910686417994, 0.501927650142829, 0.505944613867664, 0.509961577592499,
                    0.513978541317334, 0.517995505042169, 0.522012468767004, 0.526029432491839,
                    0.530046396216674, 0.534193243502132, 0.538414309965088, 0.542635376428044,
                    0.546856442891001, 0.551077509353958, 0.555298575816914, 0.559519642279871,
                    0.563740708742827, 0.567961775205784, 0.57218284166874, 0.574170675263784,
                    0.574220231275356, 0.574269787286929, 0.574319343298502, 0.574368899310075,
                    0.574418455321647, 0.57446801133322, 0.574517567344793, 0.574567123356365,
                    0.574616679367938, 0.574806439088713, 0.575178789686589, 0.575551140284464,
                    0.57592349088234, 0.576295841480216, 0.576668192078091, 0.577040542675967,
                    0.577412893273843, 0.577785243871718, 0.578157594469594, 0.578929851275342,
                    0.580501920496836, 0.58207398971833, 0.583646058939824, 0.585218128161318,
                    0.586790197382812, 0.588362266604306, 0.5899343358258, 0.591506405047294,
                    0.593078474268788, 0.594302487466449, 0.594376402498405, 0.594450317530361,
                    0.594524232562316, 0.594598147594272, 0.594672062626227, 0.594745977658183,
                    0.594819892690139, 0.594893807722094, 0.59496772275405, 0.595549050050919,
                    0.599487104638755, 0.60342515922659, 0.607363213814425, 0.611301268402261,
                    0.615239322990096, 0.619177377577931, 0.623115432165766, 0.627053486753602,
                    0.630991541341437, 0.634814534084662, 0.634955547800352, 0.635096561516043,
                    0.635237575231734, 0.635378588947425, 0.635519602663116, 0.635660616378807,
                    0.635801630094497, 0.635942643810188, 0.636083657525879, 0.63622467124157,
                    0.638661147340089, 0.641272278185128, 0.643883409030166, 0.646494539875205,
                    0.649105670720243, 0.651716801565282, 0.65432793241032, 0.656939063255359,
                    0.659550194100398, 0.662161324945436, 0.666657355513104, 0.671544157974487,
                    0.676430960435871, 0.681317762897254, 0.686204565358638, 0.691091367820022,
                    0.695978170281406, 0.700864972742789, 0.705751775204173, 0.710638577665556,
                    0.712018258072319, 0.712082767708598, 0.712147277344878, 0.712211786981157,
                    0.712276296617437, 0.712340806253716, 0.712405315889996, 0.712469825526275,
                    0.712534335162554, 0.712598844798834, 0.714259906442763, 0.716873749123517,
                    0.71948759180427, 0.722101434485023, 0.724715277165776, 0.72732911984653,
                    0.729942962527283, 0.732556805208036, 0.735170647888789, 0.737784490569543,
                    0.739414806978925, 0.740156166950721, 0.740897526922518, 0.741638886894314,
                    0.742380246866111, 0.743121606837908, 0.743862966809704, 0.744604326781501,
                    0.745345686753298, 0.746087046725094, 0.747752780990112, 0.750673023224501,
                    0.75359326545889, 0.756513507693279, 0.759433749927669, 0.762353992162058,
                    0.765274234396447, 0.768194476630836, 0.771114718865225, 0.774034961099614,
                    0.776319642656741, 0.777273619045849, 0.778227595434957, 0.779181571824065,
                    0.780135548213173, 0.781089524602281, 0.782043500991389, 0.782997477380498,
                    0.783951453769606, 0.784905430158714, 0.786067062565719, 0.787955491035365,
                    0.789843919505011, 0.791732347974657, 0.793620776444303, 0.795509204913949,
                    0.797397633383595, 0.799286061853241, 0.801174490322887, 0.803062918792533,
                    0.804744691745668, 0.8049282122041, 0.805111732662532, 0.805295253120964,
                    0.805478773579396, 0.805662294037828, 0.805845814496259, 0.806029334954691,
                    0.806212855413123, 0.806396375871555, 0.806749880524851, 0.815347618628991,
                    0.823945356733133, 0.832543094837275, 0.841140832941417, 0.849738571045558,
                    0.8583363091497, 0.866934047253842, 0.875531785357984, 0.884129523462124,
                    0.892727261566266, 0.898255279647098, 0.903513432231375, 0.908771584815651,
                    0.914029737399928, 0.919287889984205, 0.924546042568482, 0.929804195152758,
                    0.935062347737035, 0.940320500321312, 0.945578652905588, 0.950025525872496,
                    0.954292114479989, 0.958558703087482, 0.962825291694974, 0.967091880302467,
                    0.97135846890996, 0.975625057517452, 0.979891646124945, 0.984158234732437,
                    0.98842482333993, 0.992819306467815, 0.997264226871347, 1.00170914727488,
                    1.00615406767841, 1.01059898808194, 1.01504390848548, 1.01948882888901,
                    1.02393374929254, 1.02837866969607, 1.03282359009961, 1.03477603640358,
                    1.03517579392422, 1.03557555144486, 1.03597530896551, 1.03637506648615,
                    1.03677482400679, 1.03717458152744, 1.03757433904808, 1.03797409656872,
                    1.03837385408936, 1.03958894623364, 1.04157141214133, 1.04355387804902,
                    1.04553634395672, 1.04751880986441, 1.0495012757721, 1.05148374167979,
                    1.05346620758749, 1.05544867349518, 1.05743113940287, 1.06911558519012,
                    1.09452478300209, 1.11993398081407, 1.14534317862605, 1.17075237643802,
                    1.19616157425, 1.22157077206198, 1.24697996987395, 1.27238916768593,
                    1.29779836549791, 1.32009016223901, 1.33554378888919, 1.35099741553936,
                    1.36645104218953, 1.38190466883971, 1.39735829548988, 1.41281192214005,
                    1.42826554879022, 1.4437191754404, 1.45917280209057, 1.47296641305901,
                    1.48059425149529, 1.48822208993156, 1.49584992836784, 1.50347776680412,
                    1.5111056052404, 1.51873344367667, 1.52636128211295, 1.53398912054923,
                    1.54161695898551, 1.54951183577308, 1.55954301937104, 1.56957420296901,
                    1.57960538656697, 1.58963657016493, 1.5996677537629, 1.60969893736086,
                    1.61973012095882, 1.62976130455678, 1.63979248815475, 1.64974262266904,
                    1.65174994698386, 1.65375727129868, 1.6557645956135, 1.65777191992832,
                    1.65977924424314, 1.66178656855796, 1.66379389287278, 1.6658012171876,
                    1.66780854150242, 1.66981586581724, 1.67059873385423, 1.67125915626343,
                    1.67191957867263, 1.67258000108183, 1.67324042349103, 1.67390084590023,
                    1.67456126830944, 1.67522169071864, 1.67588211312784, 1.67654253553704,
                    1.68000364513601, 1.68412991794255, 1.68825619074909, 1.69238246355563,
                    1.69650873636216, 1.7006350091687, 1.70476128197524, 1.70888755478178,
                    1.71301382758832, 1.71714010039486, 1.7279459880858, 1.74151914480029,
                    1.75509230151477, 1.76866545822926, 1.78223861494375, 1.79581177165823,
                    1.80938492837272, 1.82295808508721, 1.83653124180169, 1.85010439851618,
                    1.85578130735694, 1.85632565507978, 1.85687000280262, 1.85741435052546,
                    1.8579586982483, 1.85850304597114, 1.85904739369398, 1.85959174141682,
                    1.86013608913966, 1.8606804368625, 1.8626709235164, 1.86607862632273,
                    1.86948632912907, 1.8728940319354, 1.87630173474173, 1.87970943754807,
                    1.8831171403544, 1.88652484316073, 1.88993254596706, 1.8933402487734,
                    1.89636449879016, 1.89882315594231, 1.90128181309446, 1.90374047024662,
                    1.90619912739877, 1.90865778455092, 1.91111644170307, 1.91357509885523,
                    1.91603375600738, 1.91849241315953, 1.92053511022657, 1.92162109909784,
                    1.92270708796911, 1.92379307684038, 1.92487906571166, 1.92596505458293,
                    1.9270510434542, 1.92813703232547, 1.92922302119674, 1.93030901006802,
                    1.9370653426666, 1.96621953298806, 1.99537372330952, 2.02452791363098,
                    2.05368210395244, 2.0828362942739, 2.11199048459536, 2.14114467491681,
                    2.17029886523827, 2.19945305555973, 2.23315070576766, 2.30728514896509,
                    2.38141959216254, 2.45555403535999, 2.52968847855743, 2.60382292175487,
                    2.67795736495232, 2.75209180814976, 2.82622625134721, 2.90036069454465,
                    2.97449513774209
                }
            )
        },
        {
            "WeightedCase1", new TestData(
                new[] {1.0, 2.0, 3.0, 4.0, 5.0},
                new Probability[] {0.5},
                new[] {3.0},
                new[] {0.0, 1.0, 1.0, 1.0, 0.0})
        },
        {
            "WeightedCase2", new TestData(
                new[] {1.0, 2.0, 3.0, 4.0, 5.0},
                new Probability[] {0.5},
                new[] {2.0},
                new[] {1.0, 1.0, 1.0, 0.0, 0.0})
        },
        {
            "WeightedCase3", new TestData(
                new[] {1.0, 2.0, 3.0, 4.0, 5.0},
                new Probability[] {0.5},
                new[] {2.0},
                new[] {1.0, 1.0, 0.0, 0.0, 1.0})
        },
        {
            "WeightedCase4", new TestData(
                new[] {1.0, 2.0, 3.0, 4.0, 5.0},
                new Probability[] {0.5},
                new[] {2.0},
                new[] {1.0, 1.0, 0.2, 0.4, 0.4})
        },
        {
            "WeightedCase5", new TestData(
                new[] {1.0, 2.0, 3.0, 4.0, 5.0},
                new Probability[] {0.5},
                new[] {3.0},
                new[] {1.0, 0.0, 0.0, 0.0, 1.0})
        },
        {
            "WeightedCase6", new TestData(
                new[] {1.0, 2.0, 3.0, 4.0, 5.0},
                new Probability[] {0.5},
                new[] {2.975124378109453},
                new[] {1.0, 0.01, 0.0, 0.0, 1.0})
        }
    };

    [UsedImplicitly] public static TheoryData<string> TestDataKeys = TheoryDataHelper.Create(TestDataMap.Keys);

    [Theory]
    [MemberData(nameof(TestDataKeys))]
    public void SampleQuantileEstimatorTest(string testDataKey)
    {
        Check(SimpleQuantileEstimator.Instance, TestDataMap[testDataKey]);
    }
}